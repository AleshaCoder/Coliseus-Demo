# ü™ê DigitalSpace Multiplayer Room (Unity + Colyseus)

–ú–æ–¥—É–ª—å–Ω–∞—è –º—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –Ω–∞ **Unity (Client)** –∏ **Colyseus (Server)**.  
–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç –±–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä ‚Äî –∫–æ–º–Ω–∞—Ç—É —Å –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ–º –∏–≥—Ä–æ–∫–æ–≤ –ø–æ WASD  
–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π –ø–æ–∑–∏—Ü–∏–π —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–µ—Ä–Ω—É—é –∫–æ–º–Ω–∞—Ç—É `WASDRoom`.

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º **SOLID**, **–º–æ–¥—É–ª—å–Ω–æ–≥–æ –º–æ–Ω–æ–ª–∏—Ç–∞**  
–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–∑–¥–µ–ª—è–µ—Ç –∫–ª–∏–µ–Ω—Ç—Å–∫—É—é –∏ —Å–µ—Ä–≤–µ—Ä–Ω—É—é —á–∞—Å—Ç–∏.

---

## üß± –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```mermaid
graph TD
    subgraph client["Client (Unity)"]
        A["Input: WASD, Gamepad, etc"] --> B["Movement: IMover, PlaneMover"]
        B --> C[LocalUnitSync]
        C --> D[ColyseusRoomService]
    end

    subgraph server["Server (Colyseus)"]
        E[WASDRoom]
        E --> F["State (MapSchema&lt;Player&gt;)"]
    end

    D --> E
    E --> D2["RoomService (other clients)"]
    D2 --> C2[RemoteUnitSync]
    C2 --> B2["Remote Mover"]


```

| –ú–æ–¥—É–ª—å              | –ó–∞–¥–∞—á–∞                                                                           | –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏   |
| ------------------- | -------------------------------------------------------------------------------- | ------------- |
| **Input**           | –°—á–∏—Ç—ã–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞, —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ (WASD, –≥–µ–π–º–ø–∞–¥ –∏ —Ç.–¥.) | ‚Äì             |
| **Movement**        | –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –ø–æ –ø–ª–æ—Å–∫–æ—Å—Ç–∏, –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å IMover, –±–∞–∑–æ–≤–∞—è —Ñ–∏–∑–∏–∫–∞                       | Input         |
| **Net**             | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º Colyseus, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–Ω–∞—Ç–∞–º–∏                          | Movement      |
| **Gameplay**        | –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –∏–≥—Ä–æ–∫–æ–≤, —Å–ø–∞–≤–Ω –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∏ —É–¥–∞–ª—ë–Ω–Ω—ã—Ö —é–Ω–∏—Ç–æ–≤                          | Net, Movement |
| **CompositionRoot** | –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, —Å–æ–∑–¥–∞—ë—Ç –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∏ —Å–≤—è–∑—ã–≤–∞–µ—Ç –º–æ–¥—É–ª–∏                              | –í—Å—ë           |

## üîÑ –ü–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

1. **CompositionRoot** –∑–∞–ø—É—Å–∫–∞–µ—Ç GameCompositionRoot ‚Üí —Å–æ–∑–¥–∞—ë—Ç ColyseusNetworkClient, ColyseusRoomService, PlayerPresenter

2. **PlayerPresenter** –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –∫–æ–º–Ω–∞—Ç–µ ‚Üí —Å–ø–∞–≤–Ω–∏—Ç –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞ (LocalUnitSync)

3. –õ–æ–∫–∞–ª—å–Ω—ã–π –∏–≥—Ä–æ–∫ –¥–≤–∏–≥–∞–µ—Ç—Å—è (PlaneMover ‚Üê WasdInputSource)

4. –ö–∞–∂–¥—ã–µ N –º—Å (NetConfig.SendRate) –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ–∑–∏—Ü–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä

5. –°–µ—Ä–≤–µ—Ä –æ–±–Ω–æ–≤–ª—è–µ—Ç State.players –∏ —Ä–∞—Å—Å—ã–ª–∞–µ—Ç –ø–∞—Ç—á

6. –£–¥–∞–ª—ë–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –ø–æ–ª—É—á–∞—é—Ç OnChange ‚Üí RemoteUnitSync.PushPosition()

7. RemoteUnitSync –∏–Ω—Ç–µ—Ä–ø–æ–ª–∏—Ä—É–µ—Ç –ø–ª–∞–≤–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤

## üß† –ü—Ä–∏–Ω—Ü–∏–ø—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

* **SOLID** ‚Äî –∫–∞–∂–¥—ã–π –∫–ª–∞—Å—Å –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ–¥–∏–Ω –∞—Å–ø–µ–∫—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, IMover ‚â† –≤–≤–æ–¥ ‚â† —Å–µ—Ç—å)

* **–ú–æ–¥—É–ª—å–Ω—ã–π –º–æ–Ω–æ–ª–∏—Ç** ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–µ namespace –∏ —Å–±–æ—Ä–∫–∏ (.asmdef)
–ø–æ–∑–≤–æ–ª—è—é—Ç —Ä–∞–∑–≤–∏–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –±–µ–∑ –∂—ë—Å—Ç–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

* **Dependency Injection (Composition Root)** ‚Äî –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ GameCompositionRoot,
–∞ –Ω–µ —á–µ—Ä–µ–∑ —Å–∏–Ω–≥–ª—Ç–æ–Ω—ã –∏–ª–∏ DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

**1. Colyseus Server**
 * –ó–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä npm run dev
 * –ê–¥—Ä–µ—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: ws://localhost:2567

**2. Unity**
 * –£—Å—Ç–∞–Ω–æ–≤–∏ –ø–∞–∫–µ—Ç colyseus-unity –≤–µ—Ä—Å–∏–∏ 0.14.x
 * –ü–æ–¥–∫–ª—é—á–∏ –ø—Ä–µ—Ñ–∞–±—ã:
    - PlayerLocal.prefab
    - PlayerRemote.prefab

 * –°–æ–∑–¥–∞–π –∫–æ–Ω—Ñ–∏–≥–∏:
    - MovementConfig.asset
    - NetConfig.asset

 * –î–æ–±–∞–≤—å GameCompositionRoot –Ω–∞ —Å—Ü–µ–Ω—É

 * Play

**3. –ó–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä**

**4. –ó–∞–ø—É—Å—Ç–∏ —Å—Ü–µ–Ω—É –≤ Unity**




